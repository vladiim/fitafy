class window.AddExerciseToWorkout

  constructor: (@link) ->
    @params = $.param( { workout_exercise: { workout_id: @link.data('workout_id'), exercise_id: @link.data('exercise_id') } })

  init: ->
    @link.on 'click', (event) =>
      event.preventDefault()
      @createWorkoutExercise()

  createWorkoutExercise: =>
    $.ajax {
      url: "/workout_exercises?#{@params}",
      type: 'POST',
      dataType: 'json',

      success: (data) =>
        'something'

      failure: => alert('Sorry something went wrong! Try again...')
    }

# need to listen when DOM nodes are inserted because the
# ADD exercise to workout link is generated by ExerciseModalLoader
if $('.modal#add_workout_exercise')
  document.body.addEventListener "DOMNodeInserted", (event) =>
    @element  = $( event.target )
  
    if element.hasClass('exercise_list_item')
      @link = $(@element).find('a.add_exercise_to_workout_button')
      if link.length > 0
        add_exercise_to_workout = new AddExerciseToWorkout @link
        add_exercise_to_workout.init()